[["index.html", "Analyze the Change of New York House Prices from 2000-2020 Chapter 1 Introduction", " Analyze the Change of New York House Prices from 2000-2020 Yu Cheng | Hui Li 2022-05-04 Chapter 1 Introduction "],["data-sources.html", "Chapter 2 Data sources", " Chapter 2 Data sources "],["data-transformation.html", "Chapter 3 Data transformation 3.1 Import Data 3.2 Data Transformation", " Chapter 3 Data transformation 3.1 Import Data The Department of Finance’s Rolling Sales files lists properties that sold in the last twelve-month period in New York City. We display the variables names of the datasets: ## [1] &quot;BOROUGH&quot; &quot;NEIGHBORHOOD&quot; &quot;BUILDING CLASS CATEGORY&quot; ## [4] &quot;TAX CLASS AT PRESENT&quot; &quot;BLOCK&quot; &quot;LOT&quot; ## [7] &quot;EASEMENT&quot; &quot;BUILDING CLASS AT PRESENT&quot; &quot;ADDRESS&quot; ## [10] &quot;APARTMENT NUMBER&quot; &quot;ZIP CODE&quot; &quot;RESIDENTIAL UNITS&quot; ## [13] &quot;COMMERCIAL UNITS&quot; &quot;TOTAL UNITS&quot; &quot;LAND SQUARE FEET&quot; ## [16] &quot;GROSS SQUARE FEET&quot; &quot;YEAR BUILT&quot; &quot;TAX CLASS AT TIME OF SALE&quot; ## [19] &quot;BUILDING CLASS AT TIME OF SALE&quot; &quot;SALE PRICE&quot; &quot;SALE DATE&quot; Pick a dataset to take a brief look at: ## # A tibble: 7,593 × 21 ## BOROUGH NEIGHBORHOOD `BUILDING CLASS CATEGORY` `TAX CLASS AT PR… BLOCK LOT EASEMENT `BUILDING CLASS… ADDRESS `APARTMENT NUMB… ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 2 BATHGATE 01 ONE FAMILY DWELLINGS 1 3037 101 NA S0 443 EA… &lt;NA&gt; ## 2 2 BATHGATE 01 ONE FAMILY DWELLINGS 1 3039 63 NA A1 469 EA… &lt;NA&gt; ## 3 2 BATHGATE 01 ONE FAMILY DWELLINGS 1 3045 12 NA A1 2052 B… &lt;NA&gt; ## 4 2 BATHGATE 01 ONE FAMILY DWELLINGS 1 3046 39 NA A1 2075 B… &lt;NA&gt; ## 5 2 BATHGATE 01 ONE FAMILY DWELLINGS 1 3048 28 NA A1 540 E … &lt;NA&gt; ## 6 2 BATHGATE 01 ONE FAMILY DWELLINGS 1 3053 108 NA A9 2317 B… &lt;NA&gt; ## 7 2 BATHGATE 02 TWO FAMILY DWELLINGS 1 2912 135 NA B1 492 CL… &lt;NA&gt; ## 8 2 BATHGATE 02 TWO FAMILY DWELLINGS 1 2912 145 NA B1 3811 3… &lt;NA&gt; ## 9 2 BATHGATE 02 TWO FAMILY DWELLINGS 1 2912 145 NA B1 3811 3… &lt;NA&gt; ## 10 2 BATHGATE 02 TWO FAMILY DWELLINGS 1 2912 146 NA B1 3809 3… &lt;NA&gt; ## # … with 7,583 more rows, and 11 more variables: ZIP CODE &lt;dbl&gt;, RESIDENTIAL UNITS &lt;dbl&gt;, COMMERCIAL UNITS &lt;dbl&gt;, ## # TOTAL UNITS &lt;dbl&gt;, LAND SQUARE FEET &lt;dbl&gt;, GROSS SQUARE FEET &lt;dbl&gt;, YEAR BUILT &lt;dbl&gt;, TAX CLASS AT TIME OF SALE &lt;chr&gt;, ## # BUILDING CLASS AT TIME OF SALE &lt;chr&gt;, SALE PRICE &lt;dbl&gt;, SALE DATE &lt;dttm&gt; 3.2 Data Transformation 3.2.1 Combine the five tables into one Before combine: ## Length Class Mode ## 23615 character character After combine: ## Length Class Mode ## 99183 character character 3.2.2 Add one new column to the dataset and Rearrange the order of the columns ## # A tibble: 6 × 22 ## BOROUGH Name NEIGHBORHOOD `BUILDING CLASS… `TAX CLASS AT P… BLOCK LOT EASEMENT `BUILDING CLASS… ADDRESS `APARTMENT NUMB… ## &lt;chr&gt; &lt;fct&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 1 Manhattan ALPHABET CITY 02 TWO FAMILY D… 1 377 70 NA B1 235 EA… &lt;NA&gt; ## 2 1 Manhattan ALPHABET CITY 07 RENTALS - WA… 2 376 54 NA C4 719 EA… &lt;NA&gt; ## 3 1 Manhattan ALPHABET CITY 07 RENTALS - WA… 2 385 46 NA C4 248 EA… &lt;NA&gt; ## 4 1 Manhattan ALPHABET CITY 07 RENTALS - WA… 2 386 53 NA C1 233 EA… &lt;NA&gt; ## 5 1 Manhattan ALPHABET CITY 07 RENTALS - WA… 2B 389 47 NA C4 627 EA… &lt;NA&gt; ## 6 1 Manhattan ALPHABET CITY 07 RENTALS - WA… 2 390 57 NA C7 197 EA… &lt;NA&gt; ## # … with 11 more variables: ZIP CODE &lt;dbl&gt;, RESIDENTIAL UNITS &lt;dbl&gt;, COMMERCIAL UNITS &lt;dbl&gt;, TOTAL UNITS &lt;dbl&gt;, ## # LAND SQUARE FEET &lt;dbl&gt;, GROSS SQUARE FEET &lt;dbl&gt;, YEAR BUILT &lt;dbl&gt;, TAX CLASS AT TIME OF SALE &lt;chr&gt;, ## # BUILDING CLASS AT TIME OF SALE &lt;chr&gt;, SALE PRICE &lt;dbl&gt;, SALE DATE &lt;dttm&gt; 3.2.3 Rename and display all variables name of new dataset ## [1] &quot;BOROUGH&quot; &quot;Name&quot; &quot;NEIGHBORHOOD&quot; ## [4] &quot;TAX CLASS AT PRESENT&quot; &quot;BLOCK&quot; &quot;LOT&quot; ## [7] &quot;EASEMENT&quot; &quot;BUILDING CLASS AT PRESENT&quot; &quot;ADDRESS&quot; ## [10] &quot;APARTMENT NUMBER&quot; &quot;ZIP CODE&quot; &quot;BUILDING_CLASS_CATEGORY&quot; ## [13] &quot;RESIDENTIAL_UNITS&quot; &quot;COMMERCIAL_UNITS&quot; &quot;TOTAL_UNITS&quot; ## [16] &quot;LAND_SQUARE_FEET&quot; &quot;GROSS_SQUARE_FEET&quot; &quot;YEAR_BUILT&quot; ## [19] &quot;TAX_CLASS_AT_TIME_OF_SALE&quot; &quot;BUILDING_CLASS_AT_TIME_OF_SALE&quot; &quot;SALE_PRICE&quot; ## [22] &quot;SALE_DATE&quot; 3.2.4 Remove the columns and rows we don’t need Before remove: ## [1] &quot;BOROUGH&quot; &quot;Name&quot; &quot;NEIGHBORHOOD&quot; ## [4] &quot;TAX CLASS AT PRESENT&quot; &quot;BLOCK&quot; &quot;LOT&quot; ## [7] &quot;EASEMENT&quot; &quot;BUILDING CLASS AT PRESENT&quot; &quot;ADDRESS&quot; ## [10] &quot;APARTMENT NUMBER&quot; &quot;ZIP CODE&quot; &quot;BUILDING_CLASS_CATEGORY&quot; ## [13] &quot;RESIDENTIAL_UNITS&quot; &quot;COMMERCIAL_UNITS&quot; &quot;TOTAL_UNITS&quot; ## [16] &quot;LAND_SQUARE_FEET&quot; &quot;GROSS_SQUARE_FEET&quot; &quot;YEAR_BUILT&quot; ## [19] &quot;TAX_CLASS_AT_TIME_OF_SALE&quot; &quot;BUILDING_CLASS_AT_TIME_OF_SALE&quot; &quot;SALE_PRICE&quot; ## [22] &quot;SALE_DATE&quot; ## # A tibble: 6 × 22 ## BOROUGH Name NEIGHBORHOOD `TAX CLASS AT PRESENT` BLOCK LOT EASEMENT `BUILDING CLASS… ADDRESS `APARTMENT NUMB… `ZIP CODE` ## &lt;chr&gt; &lt;fct&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 1 Manhattan ALPHABET CITY 1 377 70 NA B1 235 EA… &lt;NA&gt; 10009 ## 2 1 Manhattan ALPHABET CITY 2 376 54 NA C4 719 EA… &lt;NA&gt; 10009 ## 3 1 Manhattan ALPHABET CITY 2 385 46 NA C4 248 EA… &lt;NA&gt; 10009 ## 4 1 Manhattan ALPHABET CITY 2 386 53 NA C1 233 EA… &lt;NA&gt; 10009 ## 5 1 Manhattan ALPHABET CITY 2B 389 47 NA C4 627 EA… &lt;NA&gt; 10009 ## 6 1 Manhattan ALPHABET CITY 2 390 57 NA C7 197 EA… &lt;NA&gt; 10009 ## # … with 11 more variables: BUILDING_CLASS_CATEGORY &lt;chr&gt;, RESIDENTIAL_UNITS &lt;dbl&gt;, COMMERCIAL_UNITS &lt;dbl&gt;, TOTAL_UNITS &lt;dbl&gt;, ## # LAND_SQUARE_FEET &lt;dbl&gt;, GROSS_SQUARE_FEET &lt;dbl&gt;, YEAR_BUILT &lt;dbl&gt;, TAX_CLASS_AT_TIME_OF_SALE &lt;chr&gt;, ## # BUILDING_CLASS_AT_TIME_OF_SALE &lt;chr&gt;, SALE_PRICE &lt;dbl&gt;, SALE_DATE &lt;dttm&gt; Because there are some variables that are not useful for our study of house price changes in New York, and in addition to that, we do not need houses with transactions below $1,000, so we remove them. ## [1] &quot;BOROUGH&quot; &quot;Name&quot; &quot;NEIGHBORHOOD&quot; ## [4] &quot;BUILDING_CLASS_CATEGORY&quot; &quot;RESIDENTIAL_UNITS&quot; &quot;COMMERCIAL_UNITS&quot; ## [7] &quot;TOTAL_UNITS&quot; &quot;LAND_SQUARE_FEET&quot; &quot;GROSS_SQUARE_FEET&quot; ## [10] &quot;YEAR_BUILT&quot; &quot;TAX_CLASS_AT_TIME_OF_SALE&quot; &quot;BUILDING_CLASS_AT_TIME_OF_SALE&quot; ## [13] &quot;SALE_PRICE&quot; &quot;SALE_DATE&quot; ## # A tibble: 6 × 14 ## BOROUGH Name NEIGHBORHOOD BUILDING_CLASS_… RESIDENTIAL_UNI… COMMERCIAL_UNITS TOTAL_UNITS LAND_SQUARE_FEET GROSS_SQUARE_FE… ## &lt;chr&gt; &lt;fct&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 Manhattan ALPHABET CITY 02 TWO FAMILY D… 2 0 2 882 2160 ## 2 1 Manhattan ALPHABET CITY 07 RENTALS - WA… 20 0 20 2302 9750 ## 3 1 Manhattan ALPHABET CITY 07 RENTALS - WA… 29 0 29 3927 17754 ## 4 1 Manhattan ALPHABET CITY 07 RENTALS - WA… 10 0 10 2248 6985 ## 5 1 Manhattan ALPHABET CITY 07 RENTALS - WA… 25 5 30 3839 18836 ## 6 1 Manhattan ALPHABET CITY 07 RENTALS - WA… 8 0 8 1859 5340 ## # … with 5 more variables: YEAR_BUILT &lt;dbl&gt;, TAX_CLASS_AT_TIME_OF_SALE &lt;chr&gt;, BUILDING_CLASS_AT_TIME_OF_SALE &lt;chr&gt;, ## # SALE_PRICE &lt;dbl&gt;, SALE_DATE &lt;dttm&gt; "],["missing-values.html", "Chapter 4 Missing values 4.1 Describe the missing values 4.2 Exploring the missing values 4.3 Excluding Missing Values from Analyses", " Chapter 4 Missing values 4.1 Describe the missing values ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.000 0.000 3.000 2.274 5.000 6.000 ## LAND_SQUARE_FEET GROSS_SQUARE_FEET COMMERCIAL_UNITS RESIDENTIAL_UNITS ## 40310 40310 37875 21272 ## TOTAL_UNITS YEAR_BUILT BOROUGH Name ## 18837 5302 0 0 ## NEIGHBORHOOD BUILDING_CLASS_CATEGORY TAX_CLASS_AT_TIME_OF_SALE BUILDING_CLASS_AT_TIME_OF_SALE ## 0 0 0 0 ## SALE_PRICE SALE_DATE ## 0 0 ## [1] 6 ## # A tibble: 6 × 3 ## n_miss_in_var n_vars pct_vars ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; ## 1 0 8 57.1 ## 2 5302 1 7.14 ## 3 18837 1 7.14 ## 4 21272 1 7.14 ## 5 37875 1 7.14 ## 6 40310 2 14.3 Firstly, we describe missing patterns by row, and we can know the maximum numbers of missing value for a row is 6. And the minimum numbers of missing value for a row is 0. Since the mean of numbers of missing value is 2.274, we can find that the most rows who have the numbers of missing value are less or equal to 5. Second, we describe missing patterns by column, and from the result we can see that BOROUGH, Name, NEIGHBORHOOD, BUILDING_CLASS_CATEGORY, TAX_CLASS_AT_TIME_OF_SALE, BUILDING_CLASS_AT_TIME_OF_SALE, SALE_PRICE and SALE_DATE do not have missing value. We conclude that there are total 6 missing variables. Last, from the table above we know that there are 8 variables with 0 missings, comprising 57.14% of variables in the data set. There is 1 variable with 5302 missings.There is 1 variable with 18837 missings. 4.2 Exploring the missing values The above graph provides a summary of whether the data is missing or not. It also provides the amount of missings in each columns. So here, LAND_SQUARE_FEET and GROSS_SQUARE_FEET have the most missing data, with LAND_SQUARE_FEET having 55.93% missing data and GROSS_SQUARE_FEET have 55.93%. We also try to add facets in above plots with different Borough. ## [1] 163906 ## NOTE: The following pairs of variables appear to have the same missingness pattern. ## Please verify whether they are in fact logically distinct variables. ## [,1] [,2] ## [1,] &quot;LAND_SQUARE_FEET&quot; &quot;GROSS_SQUARE_FEET&quot; ## NOTE: In the following pairs of variables, the missingness pattern of the second is a subset of the first. ## Please verify whether they are in fact logically distinct variables. ## [,1] [,2] ## [1,] &quot;RESIDENTIAL_UNITS&quot; &quot;TOTAL_UNITS&quot; ## [2,] &quot;COMMERCIAL_UNITS&quot; &quot;TOTAL_UNITS&quot; ## NOTE: In the following pairs of variables, the missingness pattern of the second is a subset of the first. ## Please verify whether they are in fact logically distinct variables. ## [,1] [,2] ## [1,] &quot;RESIDENTIAL_UNITS&quot; &quot;TOTAL_UNITS&quot; ## [2,] &quot;COMMERCIAL_UNITS&quot; &quot;TOTAL_UNITS&quot; ## NOTE: The following pairs of variables appear to have the same missingness pattern. ## Please verify whether they are in fact logically distinct variables. ## [,1] [,2] ## [1,] &quot;LAND_SQUARE_FEET&quot; &quot;GROSS_SQUARE_FEET&quot; These four graphs show that the information on the missing value of the data set. There are 163906 values missing in it. Since there are 72067 rows in the data set, we choose to do graphs visualization every 20,000 rows. 4.3 Excluding Missing Values from Analyses When dealing with data that is missing at random, related data can be deleted to reduce bias. We delete the columns with missing values above 20,000 and then drop the missing values. After removing rows with missing values, we get: ## [1] &quot;BOROUGH&quot; &quot;Name&quot; &quot;NEIGHBORHOOD&quot; ## [4] &quot;BUILDING_CLASS_CATEGORY&quot; &quot;TOTAL_UNITS&quot; &quot;YEAR_BUILT&quot; ## [7] &quot;TAX_CLASS_AT_TIME_OF_SALE&quot; &quot;BUILDING_CLASS_AT_TIME_OF_SALE&quot; &quot;SALE_PRICE&quot; ## [10] &quot;SALE_DATE&quot; ## tibble [48,156 × 10] (S3: tbl_df/tbl/data.frame) ## $ BOROUGH : chr [1:48156] &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;1&quot; ... ## $ Name : Factor w/ 5 levels &quot;Bronx&quot;,&quot;Brooklyn&quot;,..: 3 3 3 3 3 3 3 3 3 3 ... ## $ NEIGHBORHOOD : chr [1:48156] &quot;ALPHABET CITY&quot; &quot;ALPHABET CITY&quot; &quot;ALPHABET CITY&quot; &quot;ALPHABET CITY&quot; ... ## $ BUILDING_CLASS_CATEGORY : chr [1:48156] &quot;02 TWO FAMILY DWELLINGS&quot; &quot;07 RENTALS - WALKUP APARTMENTS&quot; &quot;07 RENTALS - WALKUP APARTMENTS&quot; &quot;07 RENTALS - WALKUP APARTMENTS&quot; ... ## $ TOTAL_UNITS : num [1:48156] 2 20 29 10 30 8 10 9 10 10 ... ## $ YEAR_BUILT : num [1:48156] 2003 1900 1910 1910 1900 ... ## $ TAX_CLASS_AT_TIME_OF_SALE : chr [1:48156] &quot;1&quot; &quot;2&quot; &quot;2&quot; &quot;2&quot; ... ## $ BUILDING_CLASS_AT_TIME_OF_SALE: chr [1:48156] &quot;B1&quot; &quot;C4&quot; &quot;C1&quot; &quot;C4&quot; ... ## $ SALE_PRICE : num [1:48156] 3025000 154196 7500000 5650000 11600000 ... ## $ SALE_DATE : POSIXct[1:48156], format: &quot;2021-12-16&quot; &quot;2021-06-11&quot; &quot;2021-06-14&quot; &quot;2022-03-30&quot; ... ## - attr(*, &quot;na.action&quot;)= &#39;omit&#39; Named int [1:23911] 17 18 19 20 21 22 23 24 25 26 ... ## ..- attr(*, &quot;names&quot;)= chr [1:23911] &quot;17&quot; &quot;18&quot; &quot;19&quot; &quot;20&quot; ... ## # A tibble: 6 × 10 ## BOROUGH Name NEIGHBORHOOD BUILDING_CLASS_CATEG… TOTAL_UNITS YEAR_BUILT TAX_CLASS_AT_TIME_… BUILDING_CLASS_AT_T… SALE_PRICE ## &lt;chr&gt; &lt;fct&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 1 Manhattan ALPHABET CITY 02 TWO FAMILY DWELLI… 2 2003 1 B1 3025000 ## 2 1 Manhattan ALPHABET CITY 07 RENTALS - WALKUP … 20 1900 2 C4 154196 ## 3 1 Manhattan ALPHABET CITY 07 RENTALS - WALKUP … 29 1910 2 C1 7500000 ## 4 1 Manhattan ALPHABET CITY 07 RENTALS - WALKUP … 10 1910 2 C4 5650000 ## 5 1 Manhattan ALPHABET CITY 07 RENTALS - WALKUP … 30 1900 2 C7 11600000 ## 6 1 Manhattan ALPHABET CITY 07 RENTALS - WALKUP … 8 1900 2 C4 4500000 ## # … with 1 more variable: SALE_DATE &lt;dttm&gt; "],["results.html", "Chapter 5 Results", " Chapter 5 Results "],["interactive-component.html", "Chapter 6 Interactive component", " Chapter 6 Interactive component "],["conclusion.html", "Chapter 7 Conclusion", " Chapter 7 Conclusion "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
